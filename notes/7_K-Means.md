# K-Means

## K-Means算法

K-Means是一种将未标记的数据集分类成$n$个组的**聚类**(Cluster)算法，步骤如下

1. 随机选择$K$个点作为**聚类中心**(Cluster centroids)

2. 将每一个数据与距离最近的聚类中心关联起来，与用一个聚类中心关联的所有点聚成一类

3. 将聚类中心移动到这个类中所有点的平均位置

4. 如果出现了一个聚类中心没有关联点的情况，可以重新将这个聚类中心随机初始化到一个新的位置或者删除这个聚类中心

5. 重复2-4步直至聚类中心不再改变

下面这张图描述了K-Means算法的过程

<div align="center"><img src="https://s2.ax1x.com/2019/03/17/Aeb1oV.png" style="height:400px"/></div>

## 优化目标

1. K-Means算法的目标是使所有数据点与其关联的聚类中心的距离之和最小

    因此K-Means算法的代价函数或称**畸变函数**(Distortion function)为$$J(c, \mu)=\frac{1}{m}\sum_{i=1}^m||x^{(i)}-\mu_{c^{(i)}}||^2$$其中$c^{(i)}$表示$x^{(i)}$所属的类别，$\mu_k$表示第$k$个聚类中心，因此$\mu_{c^{(i)}}$表示$x^{(i)}$关联的聚类中心

2. K-Means算法循环中第一步降低了$c^{(i)}$引起的代价，而第二步降低了$\mu_i$引起的代价

## 随机初始化

1. 应该选择$K < m$个聚类数量，即聚类中心的数量要小于训练集的数量

2. 随机选择$K$个实例，然后取这$K$个点作为聚类中心

随机初始化存在的问题是算法可能停留在一个局部最小值，如图

<div align="center"><img src="https://s2.ax1x.com/2019/03/17/Aeqek6.png" style="height:150px"/></div>

为了解决这个问题，通常多次执行K-Means算法，每次都进行随机初始化
最后比较多次运行的结果，选取代价函数最小的结果